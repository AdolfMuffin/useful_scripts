zabbix_export:
  version: '6.2'
  date: '2022-11-10T09:50:27Z'
  template_groups:
    -
      uuid: e960332b3f6c46a1956486d4f3f99fce
      name: 'Templates/Server hardware'
  templates:
    -
      uuid: 088ba3a58c6740dd82b65d9adbad5ab2
      template: 'SSH storcli RAID checks'
      name: 'SSH storcli RAID checks'
      groups:
        -
          name: 'Templates/Server hardware'
      items:
        -
          uuid: 58c6442497a64831ac527d764531209e
          name: 'RAID controller temperature'
          type: SSH
          key: 'ssh.run[raid.controller.temp]'
          delay: 20m
          units: Â°C
          params: '{$SUDO} {$STORCLI} /call show all | grep "ROC temperature(Degree Celsius)" | awk ''{ print $5 }'''
          username: '{$SSH_USER}'
          password: '{$SSH_PW}'
          tags:
            -
              tag: 'Hardware type'
              value: Temp
      discovery_rules:
        -
          uuid: a9cdb878ca064d31b7b10f53e4a1adb9
          name: 'Physical disks discovery'
          type: SSH
          key: 'ssh.run[physical.disks.discovery]'
          delay: 1h
          params: '{$SUDO} {$SCRIPT_PATH} "{$STORCLI}" get_json_physical'
          username: '{$SSH_USER}'
          password: '{$SSH_PW}'
          lifetime: 10d
          item_prototypes:
            -
              uuid: a608a35a50ca4e64a552170c1585afb3
              name: 'Status of disk {#DISKID}'
              type: SSH
              key: 'ssh.run[disk.state.{#DISKID}]'
              delay: 20m
              trends: '0'
              value_type: TEXT
              params: '{$SUDO} {$SCRIPT_PATH} "{$STORCLI}" get_status_physical "{#DISKID}"'
              username: '{$SSH_USER}'
              password: '{$SSH_PW}'
              tags:
                -
                  tag: Type
                  value: 'Physical disk'
              trigger_prototypes:
                -
                  uuid: e4053c8ee58344aab5e74757e03b500e
                  expression: 'change(/SSH storcli RAID checks/ssh.run[disk.state.{#DISKID}])<>0'
                  name: 'State of disk {#DISKID} has been changed'
                  priority: AVERAGE
            -
              uuid: 815e1ad3d4b54c43af1f2715d670b842
              name: 'Make physical disk cache'
              type: SSH
              key: 'ssh.run[pdisk.makecache]'
              delay: 20m
              history: '0'
              trends: '0'
              value_type: TEXT
              params: '{$SUDO} {$SCRIPT_PATH} "{$STORCLI}" make_cache_physical'
              username: '{$SSH_USER}'
              password: '{$SSH_PW}'
              tags:
                -
                  tag: Type
                  value: 'Physical disk'
            -
              uuid: 5c31e5d75ec241e697b4c4329d16ef37
              name: 'S.M.A.R.T. flag state for disk {#DISKID}'
              type: SSH
              key: 'ssh.run[smart.flag.{#DISKID}]'
              delay: 20m
              trends: '0'
              value_type: TEXT
              params: '{$SUDO} {$SCRIPT_PATH} "{$STORCLI}" get_smart_physical "{#DISKID}"'
              username: '{$SSH_USER}'
              password: '{$SSH_PW}'
              tags:
                -
                  tag: Type
                  value: 'Physical disk'
              trigger_prototypes:
                -
                  uuid: ad10dbfeb2b848b488fefa421f24460b
                  expression: 'last(/SSH storcli RAID checks/ssh.run[smart.flag.{#DISKID}])<>"No"'
                  name: 'S.M.A.R.T. on disk {#DISKID} reported a problem'
                  priority: AVERAGE
        -
          uuid: 503ad7f2ccc649b0834447b77cd1e4f8
          name: 'Virtual disks discovery'
          type: SSH
          key: 'ssh.run[virtual.disks.discovery]'
          delay: 1h
          params: '{$SUDO} {$SCRIPT_PATH} "{$STORCLI}" get_json_virtual'
          username: '{$SSH_USER}'
          password: '{$SSH_PW}'
          lifetime: 10d
          item_prototypes:
            -
              uuid: 1fadb90f0d6848ed8dcc82fc108a94dc
              name: 'Make virtual disk cache'
              type: SSH
              key: 'ssh.run[vdisk.maskecache]'
              delay: 20m
              history: '0'
              trends: '0'
              value_type: TEXT
              params: '{$SUDO} {$SCRIPT_PATH} "{$STORCLI}" make_cache_virtual'
              username: '{$SSH_USER}'
              password: '{$SSH_PW}'
              tags:
                -
                  tag: Type
                  value: 'Virtual disk'
            -
              uuid: 96f2008d57454aa0be4be6cf0819479b
              name: 'State of virtual disk {#VDISKID}'
              type: SSH
              key: 'ssh.run[vdisk.state.{#VDISKID}]'
              delay: 20m
              trends: '0'
              value_type: TEXT
              params: '{$SUDO} {$SCRIPT_PATH} "{$STORCLI}" get_status_virtual "{#VDISKID}"'
              username: '{$SSH_USER}'
              password: '{$SSH_PW}'
              tags:
                -
                  tag: Type
                  value: 'Virtual disk'
              trigger_prototypes:
                -
                  uuid: 960a50ab87854fc6a7b37a0446c596db
                  expression: 'last(/SSH storcli RAID checks/ssh.run[vdisk.state.{#VDISKID}])<>"Optl"'
                  name: 'State of virtual disk {#DISKID} has been changed'
                  priority: AVERAGE
      macros:
        -
          macro: '{$SCRIPT_PATH}'
          description: 'Absolute path to the script'
        -
          macro: '{$SSH_PW}'
          description: 'SSH password'
        -
          macro: '{$SSH_USER}'
          description: 'SSH username'
        -
          macro: '{$STORCLI}'
          description: 'Absolute path to storcli utility'
        -
          macro: '{$SUDO}'
          description: 'Enter "sudo" if sudo rights are required to execute storcli, otherway, leave blank'
